---
import '../styles/navigation.css';

interface Props {
  isDesktop: boolean;
}

interface NavItem {
  title: string;
  path: string;
  submenu?: NavItem[];
}

const { isDesktop } = Astro.props;

const navigation: NavItem[] = [
  {
    title: "Services",
    path: "/plumbing-services",
    submenu: [
      { title: "Water Heaters", path: "/water-heater-repair-and-replacement" },
      { title: "Toilet Problems", path: "/clogged-or-running-toilets" },
      { title: "Clogged Drains", path: "/clogged-drains-rootered" },
      { title: "Leaking Pipes", path: "/leaking-pipes-repair" },
      { title: "Garbage Disposals", path: "/garbage-disposal-repair-or-installation" },
      { title: "Leaking Faucets", path: "/faucet-leaks-repaired" },
      { title: "Instant Hot Water", path: "/instant-hot-water-installed-or-repaired" },
      { title: "Emergencies", path: "/emergency-plumbing-services" },
      { title: "Dishwashers", path: "/dishwasher-installation-or-leak-repair" }
    ]
  },
  {
    title: "Service Regions",
    path: "/service-regions",
    submenu: [
      { title: "Sonoma County", path: "/sonoma-county-plumbing" },
      { title: "Marin County", path: "/marin-county-plumbing" }
    ]
  },
  { title: "Contact Us", path: "/contact-us" },
  { title: "FAQs", path: "/faqs" }
];

const currentPath = Astro.url.pathname;

function isActive(path: string): boolean {
  return currentPath === path || currentPath.startsWith(path + '/');
}
---

{isDesktop ? (
  <ul class="flex space-x-6">
    {navigation.map(item => (
      <li class="relative group">
        <a
          href={item.path}
          class={`nav-link ${isActive(item.path) ? 'nav-active' : ''} ${item.submenu ? 'has-submenu' : ''}`}
        >
          {item.title}
        </a>
        {item.submenu && (
          <div class="submenu-wrapper">
            <ul class="submenu-list">
              {item.submenu.map(subItem => (
                <li>
                  <a
                    href={subItem.path}
                    class={`submenu-item ${isActive(subItem.path) ? 'active' : ''}`}
                  >
                    {subItem.title}
                  </a>
                </li>
              ))}
            </ul>
          </div>
        )}
      </li>
    ))}
  </ul>
) : (
  <div class="mobile-nav">
    <ul class="mobile-nav-list">
    {navigation.map(item => (
      <li class="mobile-nav-item" data-has-submenu={!!item.submenu}>
        {!item.submenu ? (
          <a
            href={item.path}
            class={`mobile-nav-link ${isActive(item.path) ? 'active' : ''}`}
          >
            {item.title}
          </a>
        ) : (
          <div class="mobile-submenu">
            <button
              class={`mobile-submenu-button ${isActive(item.path) ? 'active' : ''}`}
              onclick="this.closest('.mobile-nav-item').classList.toggle('open')"
            >
              <span>{item.title}</span>
              <span class="mobile-submenu-icon">â–¼</span>
            </button>
            <div class="mobile-submenu-content">
              <ul class="mobile-submenu-list">
                {item.submenu.map(subItem => (
                  <li>
                    <a
                      href={subItem.path}
                      class={`mobile-nav-link ${isActive(subItem.path) ? 'active' : ''}`}
                    >
                      {subItem.title}
                    </a>
                  </li>
                ))}
              </ul>
            </div>
          </div>
        )}
      </li>
    ))}
  </ul>
  </div>
)}


